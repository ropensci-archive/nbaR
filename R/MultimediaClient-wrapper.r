# Netherlands Biodiversity Api
#
# Access to the digitised Natural History collection at the Naturalis Biodiversity Center
#
# OpenAPI spec version: v2
# Contact: support@naturalis.nl
# Generated by: https://github.com/swagger-api/swagger-codegen.git

# Multimedia client wrapper
# for nbaR.Multimedia objects

    #' @name multimedia_count
    #' @title Get the number of multimedia documents matching a given condition
    #' @description This is a wrapper for the method \code{ count }
    #' from class \code{ MultimediaClient}.
    #' @details Conditions given as query parameters or QuerySpec JSON
    #' @family nbaR.MultimediaClient-wrappers
    #' @return scalar
    #' @param queryParams Named list or vector with names being the fields to be queried and values being the values to match
    #' @param ... additional parameters passed to count from class nbaR.MultimediaClient
    #' @export
    multimedia_count <- function(
      queryParams = list(),
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$count(
     queryParams=queryParams, 
      ...)      
          result <- res$content
          return(result)
  }
    #' @name multimedia_count_distinct_values
    #' @title Count the distinct number of values that exist for a given field
    #' @description This is a wrapper for the method \code{ count_distinct_values }
    #' from class \code{ MultimediaClient}.
    #' @details 
    #' @family nbaR.MultimediaClient-wrappers
    #' @return scalar
    #' @param field Name of field in taxon object, type: 
    #' @param queryParams Named list or vector with names being the fields to be queried and values being the values to match
    #' @param ... additional parameters passed to count_distinct_values from class nbaR.MultimediaClient
    #' @export
    multimedia_count_distinct_values <- function(
        field = NULL,
      queryParams = list(),
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$count_distinct_values(
        field,
     queryParams=queryParams, 
      ...)      
          result <- res$content
          return(result)
  }
    #' @name multimedia_count_distinct_values_per_group
    #' @title Count the distinct number of field values that exist per the given field to group by
    #' @description This is a wrapper for the method \code{ count_distinct_values_per_group }
    #' from class \code{ MultimediaClient}.
    #' @details 
    #' @family nbaR.MultimediaClient-wrappers
    #' @return scalar
    #' @param group name of field in the multimedia object you want to group by, type: 
    #' @param field name of field in the multimedia object, type: 
    #' @param returnType Either \code{list} or \code{data.frame} (default)
    #' @param ... additional parameters passed to count_distinct_values_per_group from class nbaR.MultimediaClient
    #' @export
    multimedia_count_distinct_values_per_group <- function(
        group = NULL,
        field = NULL,
        returnType='data.frame',
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$count_distinct_values_per_group(
        group,
        field,
    
      ...)      
          result <- res$content
          return(result)
  }
    #' @name multimedia_download_query
    #' @title Dynamic download service: Query for multimedia objects and return result as a stream ...
    #' @description This is a wrapper for the method \code{ download_query }
    #' from class \code{ MultimediaClient}.
    #' @details Query with query parameters or querySpec JSON. ...
    #' @family nbaR.MultimediaClient-wrappers
    
    #' @param queryParams Named list or vector with names being the fields to be queried and values being the values to match
    #' @param ... additional parameters passed to download_query from class nbaR.MultimediaClient
    #' @export
    multimedia_download_query <- function(
      queryParams = list(),
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$download_query(
     queryParams=queryParams, 
      ...)      
  }
    #' @name multimedia_find
    #' @title Find a multimedia document by id
    #' @description This is a wrapper for the method \code{ find }
    #' from class \code{ MultimediaClient}.
    #' @details If found, returns a single multimedia document
    #' @family nbaR.MultimediaClient-wrappers
    #' @return list or data.frame, as specified by \code{returnType}
    #' @param id id of multimedia document, type: 
    #' @param returnType Either \code{list} or \code{data.frame} (default)
    #' @param ... additional parameters passed to find from class nbaR.MultimediaClient
    #' @export
    multimedia_find <- function(
        id = NULL,
        returnType='data.frame',
    ...) {
    
    ## check returnType argument
    if (! returnType %in% c("list", "data.frame")) {
      stop("Invalid returnType argument. Must be 'data.frame' or 'list'")
    }
    
    sc <- MultimediaClient$new()
    res <- sc$find(
        id,
    
      ...)      
          ## return simpler data structure for object response
          result <- .un_object(res, returnType=returnType)
          return(result)
  }
    #' @name multimedia_find_by_ids
    #' @title Find multimedia document by ids
    #' @description This is a wrapper for the method \code{ find_by_ids }
    #' from class \code{ MultimediaClient}.
    #' @details Given multiple ids, returns a list of multimedia documents
    #' @family nbaR.MultimediaClient-wrappers
    #' @return list or data.frame, as specified by \code{returnType}
    #' @param ids ids of multiple multimedia documents, separated by comma, type: character
    #' @param returnType Either \code{list} or \code{data.frame} (default)
    #' @param ... additional parameters passed to find_by_ids from class nbaR.MultimediaClient
    #' @export
    multimedia_find_by_ids <- function(
          ids = NULL,
        returnType='data.frame',
    ...) {
    
    ## check returnType argument
    if (! returnType %in% c("list", "data.frame")) {
      stop("Invalid returnType argument. Must be 'data.frame' or 'list'")
    }
    
    sc <- MultimediaClient$new()
    res <- sc$find_by_ids(
          ids,
    
      ...)      
          ## return simpler data structure for object response
          result <- .un_object(res, returnType=returnType)
          return(result)
  }
    #' @name multimedia_get_distinct_values
    #' @title Get all different values that can be found for one field
    #' @description This is a wrapper for the method \code{ get_distinct_values }
    #' from class \code{ MultimediaClient}.
    #' @details A list of all fields for multimedia documents can be retrieved with /metadata/getFieldInfo
    #' @family nbaR.MultimediaClient-wrappers
    #' @return scalar
    #' @param field field, type: 
    #' @param returnType Either \code{list} or \code{data.frame} (default)
    #' @param ... additional parameters passed to get_distinct_values from class nbaR.MultimediaClient
    #' @export
    multimedia_get_distinct_values <- function(
        field = NULL,
        returnType='data.frame',
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$get_distinct_values(
        field,
    
      ...)      
          result <- res$content
          return(result)
  }
    #' @name multimedia_get_distinct_values_per_group
    #' @title Get all distinct values (and their document count) for the field given divided per distinct value of the field to group by
    #' @description This is a wrapper for the method \code{ get_distinct_values_per_group }
    #' from class \code{ MultimediaClient}.
    #' @details 
    #' @family nbaR.MultimediaClient-wrappers
    #' @return scalar
    #' @param group name of field in the multimedia object you want to group by, type: 
    #' @param field name of field in the multimedia object, type: 
    #' @param returnType Either \code{list} or \code{data.frame} (default)
    #' @param ... additional parameters passed to get_distinct_values_per_group from class nbaR.MultimediaClient
    #' @export
    multimedia_get_distinct_values_per_group <- function(
        group = NULL,
        field = NULL,
        returnType='data.frame',
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$get_distinct_values_per_group(
        group,
        field,
    
      ...)      
          result <- res$content
          return(result)
  }
    #' @name multimedia_get_field_info
    #' @title Returns extended information for each field of a multimedia document
    #' @description This is a wrapper for the method \code{ get_field_info }
    #' from class \code{ MultimediaClient}.
    #' @details Info consists of whether the fields is indexed, the ElasticSearch datatype and a list of allowed operators
    #' @family nbaR.MultimediaClient-wrappers
    #' @return scalar
    #' @param returnType Either \code{list} or \code{data.frame} (default)
    #' @param ... additional parameters passed to get_field_info from class nbaR.MultimediaClient
    #' @export
    multimedia_get_field_info <- function(
        returnType='data.frame',
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$get_field_info(
    
      ...)      
          result <- res$content
          return(result)
  }
    #' @name multimedia_get_paths
    #' @title Returns the full path of all fields within a document
    #' @description This is a wrapper for the method \code{ get_paths }
    #' from class \code{ MultimediaClient}.
    #' @details See also metadata/getFieldInfo for all allowed operators per field
    #' @family nbaR.MultimediaClient-wrappers
    #' @return scalar
    #' @param returnType Either \code{list} or \code{data.frame} (default)
    #' @param ... additional parameters passed to get_paths from class nbaR.MultimediaClient
    #' @export
    multimedia_get_paths <- function(
        returnType='data.frame',
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$get_paths(
    
      ...)      
          result <- res$content
          return(result)
  }
    #' @name multimedia_get_setting
    #' @title Get the value of an NBA setting
    #' @description This is a wrapper for the method \code{ get_setting }
    #' from class \code{ MultimediaClient}.
    #' @details All settings can be queried with /metadata/getSettings
    #' @family nbaR.MultimediaClient-wrappers
    #' @return scalar
    #' @param name name of setting, type: 
    #' @param ... additional parameters passed to get_setting from class nbaR.MultimediaClient
    #' @export
    multimedia_get_setting <- function(
        name = NULL,
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$get_setting(
        name,
    
      ...)      
          result <- res$content
          return(result)
  }
    #' @name multimedia_get_settings
    #' @title List all publicly available configuration settings for the NBA
    #' @description This is a wrapper for the method \code{ get_settings }
    #' from class \code{ MultimediaClient}.
    #' @details The value of a specific setting can be queried with metadata/getSetting/{name}
    #' @family nbaR.MultimediaClient-wrappers
    #' @return scalar
    #' @param returnType Either \code{list} or \code{data.frame} (default)
    #' @param ... additional parameters passed to get_settings from class nbaR.MultimediaClient
    #' @export
    multimedia_get_settings <- function(
        returnType='data.frame',
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$get_settings(
    
      ...)      
          result <- res$content
          return(result)
  }
    #' @name multimedia_is_operator_allowed
    #' @title Checks if a given operator is allowed for a given field
    #' @description This is a wrapper for the method \code{ is_operator_allowed }
    #' from class \code{ MultimediaClient}.
    #' @details See also metadata/getFieldInfo
    #' @family nbaR.MultimediaClient-wrappers
    #' @return scalar
    #' @param field multimedia document field, type: 
    #' @param operator operator, type: 
    #' @param returnType Either \code{list} or \code{data.frame} (default)
    #' @param ... additional parameters passed to is_operator_allowed from class nbaR.MultimediaClient
    #' @export
    multimedia_is_operator_allowed <- function(
        field = NULL,
        operator = NULL,
        returnType='data.frame',
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$is_operator_allowed(
        field,
        operator,
    
      ...)      
          result <- res$content
          return(result)
  }
    #' @name multimedia_query
    #' @title Query for multimedia documents
    #' @description This is a wrapper for the method \code{ query }
    #' from class \code{ MultimediaClient}.
    #' @details Search for multimedia documents with query parameters or QuerySpec JSON string
    #' @family nbaR.MultimediaClient-wrappers
    #' @return list or data.frame, as specified by \code{returnType}
    #' @param queryParams Named list or vector with names being the fields to be queried and values being the values to match
    #' @param returnType Either \code{list} or \code{data.frame} (default)
    #' @param ... additional parameters passed to query from class nbaR.MultimediaClient
    #' @export
    multimedia_query <- function(
      queryParams = list(),
        returnType='data.frame',
    ...) {
    
    ## check returnType argument
    if (! returnType %in% c("list", "data.frame")) {
      stop("Invalid returnType argument. Must be 'data.frame' or 'list'")
    }
    
    sc <- MultimediaClient$new()
    res <- sc$query(
     queryParams=queryParams, 
      ...)      
          ## return simpler data structure for object response
          result <- .un_object(res, returnType=returnType)
          return(result)
  }
    #' @name multimedia_query_with_name_resolution
    #' @title 
    #' @description This is a wrapper for the method \code{ query_with_name_resolution }
    #' from class \code{ MultimediaClient}.
    
    #' @family nbaR.MultimediaClient-wrappers
    
    #' @param querySpec , type: 
    #' @param queryParams Named list or vector with names being the fields to be queried and values being the values to match
    #' @param ... additional parameters passed to query_with_name_resolution from class nbaR.MultimediaClient
    #' @export
    multimedia_query_with_name_resolution <- function(
        querySpec = NULL,
      queryParams = list(),
    ...) {
    
    
    sc <- MultimediaClient$new()
    res <- sc$query_with_name_resolution(
        querySpec,
     queryParams=queryParams, 
      ...)      
  }

#' @noRd
#' @param response Object of class Response
#' @param returnType either 'list' or 'data.frame'
#' Internal function to convert all (nested) objects
#' in a response object to lists or data frames
.un_object <- function(response, returnType = "data.frame") {
  l <- response$content

  ## Handle return objects of class QueryResult
  if (class(l)[1] == "QueryResult") {
      tmp <- list()
      for (r in l$resultSet) {
          tmp <- append(tmp, r$item)
      }
      l <- tmp  
  }

  if (returnType == "data.frame") {
      if(! is.list(l)) {
          result <- as.data.frame(l$toList())
      } else {      
          strs <-  vapply(l, function(x)x$toJSONString(), FUN.VALUE=character(1))
          result <- jsonlite::fromJSON(
                              paste("[", paste(strs, collapse=","), "]"))
      }

  } else {
      ## Return type is list, coerce everything to list
      if (!is.list(l)) {
          result <- l$toList()
      } else {
          result <- list()
          for (i in seq_along(l)) {
              if (is.object(l[[i]])) {
                  result[[i]] <- l[[i]]$toList()
               } else {
                  result[[i]] <- l[[i]]
              }
          }    
      }
  }    
  return(result)
}
  